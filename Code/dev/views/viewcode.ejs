<!doctype html>
<html>
  <head>
    <%- include ("partials/head.ejs") -%>
    <link rel="stylesheet" href="/css/viewcode.css">
  </head>

  <body>
    <div class="container-fluid">
      <div class="col-md-12 py-5 px-3 mx-auto">
        <%- include ("partials/nav.ejs") -%>
  
        <main class="container">
            
            
         
          <% dbsnippetresults.forEach(function(item){ %> 
          <div>
            <h2><%=item[0] %></h2>
          </div>
          <div>
            <p >Contributed by <%=item[1] %></p>
          </div>
          <div>
            <p>Last updated: <%=item[3] %></p>
          </div>
          <div>
            <p><%=item[2] %></p>
          </div>
          <div>
            <section><div id="code-snippet"><%=item[6] %></div></section>
          </div>
          
          <div class="snippet-rep">
            <div class="flag">
              <a href="#"><button type="button" class="btn btn-danger"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-flag" viewBox="0 0 16 16">
                <path d="M14.778.085A.5.5 0 0 1 15 .5V8a.5.5 0 0 1-.314.464L14.5 8l.186.464-.003.001-.006.003-.023.009a12.435 12.435 0 0 1-.397.15c-.264.095-.631.223-1.047.35-.816.252-1.879.523-2.71.523-.847 0-1.548-.28-2.158-.525l-.028-.01C7.68 8.71 7.14 8.5 6.5 8.5c-.7 0-1.638.23-2.437.477A19.626 19.626 0 0 0 3 9.342V15.5a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 1 0v.282c.226-.079.496-.17.79-.26C4.606.272 5.67 0 6.5 0c.84 0 1.524.277 2.121.519l.043.018C9.286.788 9.828 1 10.5 1c.7 0 1.638-.23 2.437-.477a19.587 19.587 0 0 0 1.349-.476l.019-.007.004-.002h.001M14 1.221c-.22.078-.48.167-.766.255-.81.252-1.872.523-2.734.523-.886 0-1.592-.286-2.203-.534l-.008-.003C7.662 1.21 7.139 1 6.5 1c-.669 0-1.606.229-2.415.478A21.294 21.294 0 0 0 3 1.845v6.433c.22-.078.48-.167.766-.255C4.576 7.77 5.638 7.5 6.5 7.5c.847 0 1.548.28 2.158.525l.028.01C9.32 8.29 9.86 8.5 10.5 8.5c.668 0 1.606-.229 2.415-.478A21.317 21.317 0 0 0 14 7.655V1.222z"/>
              </svg></button></a>
            </div>
            <div class="vote">
              <a href="#"><button class="btn btn-dark" >Vote</button></a>
              <!--<input class="btn btn-dark" type="button" value="Vote">-->
            </div>
            
          </div>
          <button type="button" class="btn btn-secondary" onclick="CopyToClipboard('code-snippet')"><svg xmlns="http://www.w3.org/2000/svg" 
            width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
          </svg> Copy to Clipboard</button>
    
          
          <button type="button" class="btn btn-secondary" onclick="saveFile('code-snippet')"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-download" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
          </svg>  Download</button>

          <button onclick="window.doSharing(this)" type="button" class="btn btn-secondary" ><svg xmlns="http://www.w3.org/2000/svg" 
            width="16" height="16" fill="currentColor" class="bi bi-share" viewBox="0 0 16 16">
        <path d="M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 
        3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 
        5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
      </svg> Share</button>
      <br><br>
          <h2>Comments</h2>
          <div><%=item[7] %></div>
          
          <% }) %>
      <br><br><br><br>

        <div class='info'> 
          <form action="/commentadded" method="post" >
          <label for='message'>Type comment below!</label>
          <br>
          <% dbsnippetresults.forEach(function(item){ %> 
          <input class='form-control' id ="comment" name='comment'>
          <input type="hidden" class='form-control' id ="type" name='type' value="<%=type%>">
          <input type="hidden" class='form-control' id ="title" name='title' value="<%=item[0] %>">
          <input type="hidden" class='form-control' id ="username" name='username' value="<%=item[1] %>">
          <input type="hidden" class='form-control' id ="description" name='description' value="<%=item[2] %>">
          <input type="hidden" class='form-control' id ="last_update" name='last_update' value="<%=item[3] %>">
          <input type="hidden" class='form-control' id ="code_snippet" name='code_snippet' value="<%=item[6] %>">
          <input type="hidden" class='form-control' id ="comments" name='comments' value="<%=item[7] %>">
          <% }) %>
          <br>
        <button id="sent" type='submit' class='btn btn-success'>Submit</button>
      </form>
      </div>
      </div>

      </div>

   
        </main>
  
        <%- include ("partials/footer.ejs") -%>
      </div>
    </div>

    <script>
      function CopyToClipboard(containerid) {
        if (document.selection) {
          var range = document.body.createTextRange();
          range.moveToElementText(document.getElementById(containerid));
          range.select().createTextRange();
          document.execCommand("copy");
        } 
        else if (window.getSelection) {
            var range = document.createRange();
            range.selectNode(document.getElementById(containerid));
            window.getSelection().addRange(range);
            document.execCommand("copy");
            alert("Code snippet has been copied")
        }
      }
    
      function saveFile(containerid) {
        const snippet = document.getElementById(containerid).innerText
        let data = snippet
        
  
        const textToBLOB = new Blob([data], { type: 'text/plain' });
        const sFileName = 'code_snippet.txt';	   // The file to save the data.
        
          let newLink = document.createElement("a");
          
          newLink.download = sFileName;
  
          if (window.webkitURL != null) {
              newLink.href = window.webkitURL.createObjectURL(textToBLOB);
          }
          else {
              newLink.href = window.URL.createObjectURL(textToBLOB);
              newLink.style.display = "none";
              document.body.appendChild(newLink);
          }
  
          newLink.click(); 
      
      }

      if (navigator.share) {
        const section = document.querySelector("section");
      }

      window.doSharing = (el) => {
        navigator.share({

        text: el.parentNode.querySelector("div").innerText
        
        });
      };

  
    </script>

  
  </body>

</html>


